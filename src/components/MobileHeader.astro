---
import Home from "../icons/Home.astro";
import BuildingStore from "../icons/BuildingStore.astro";
import Book from "../icons/Book.astro";
import Building from "../icons/Building.astro";
import InfoCircle from "../icons/InfoCircle.astro";
import IconX from "../icons/IconX.astro";

const currentPath = Astro.url.pathname;
---

<!-- Backdrop Overlay -->
<div
  class="mobile-backdrop fixed inset-0 bg-black/50 backdrop-blur-sm z-[60] opacity-0 invisible transition-all duration-300 md:hidden"
>
</div>

<!-- Mobile Navigation Menu (Slide-in from right) -->
<div
  class="mobile-menu fixed top-0 right-0 h-screen w-80 max-w-[85vw] bg-white shadow-2xl z-[70] transition-transform duration-300 ease-in-out md:hidden overflow-y-auto"
  style="transform: translateX(100%);"
>
  <!-- Close Button -->
  <div
    class="flex items-center justify-between p-6 border-b border-neutral-200"
  >
    <h2 class="text-xl font-bold text-primary uppercase">Men√∫</h2>
    <button
      type="button"
      class="mobile-close-button p-2 rounded-full hover:bg-neutral-100 transition-colors"
    >
      <IconX class="w-6 h-6 text-neutral-600" />
    </button>
  </div>

  <!-- Menu Items -->
  <nav class="flex flex-col p-6 space-y-2">
    <a
      href="/"
      class={`group flex items-center px-4 py-3 rounded-lg transition-all duration-200 ${
        currentPath === "/"
          ? "bg-primary text-white"
          : "text-neutral-700 hover:bg-neutral-100"
      }`}
    >
      <Home class="w-5 h-5 mr-3" />
      <span class="font-semibold">Inicio</span>
    </a>

    <a
      href="/products"
      class={`group flex items-center px-4 py-3 rounded-lg transition-all duration-200 ${
        currentPath === "/products"
          ? "bg-primary text-white"
          : "text-neutral-700 hover:bg-neutral-100"
      }`}
    >
      <BuildingStore class="w-5 h-5 mr-3" />
      <span class="font-semibold">Productos</span>
    </a>

    <a
      href="/recipes"
      class={`group flex items-center px-4 py-3 rounded-lg transition-all duration-200 ${
        currentPath === "/recipes"
          ? "bg-primary text-white"
          : "text-neutral-700 hover:bg-neutral-100"
      }`}
    >
      <Book class="w-5 h-5 mr-3" />
      <span class="font-semibold">Recetas</span>
    </a>

    <a
      href="/mayorista"
      class={`group flex items-center px-4 py-3 rounded-lg transition-all duration-200 ${
        currentPath === "/mayorista"
          ? "bg-primary text-white"
          : "text-neutral-700 hover:bg-neutral-100"
      }`}
    >
      <Building class="w-5 h-5 mr-3" />
      <span class="font-semibold">Mayoristas</span>
    </a>

    <a
      href="/about"
      class={`group flex items-center px-4 py-3 rounded-lg transition-all duration-200 ${
        currentPath === "/about"
          ? "bg-primary text-white"
          : "text-neutral-700 hover:bg-neutral-100"
      }`}
    >
      <InfoCircle class="w-5 h-5 mr-3" />
      <span class="font-semibold">Nosotros</span>
    </a>
  </nav>

  <!-- CTA Section -->
  <div class="absolute bottom-0 left-0 right-0 p-6 border-t border-neutral-200">
    <a
      href="https://www.hardymarket.com.ar/"
      target="_blank"
      rel="noopener noreferrer"
      class="block w-full bg-primary hover:bg-primary-600 text-white px-6 py-3 rounded-full font-semibold text-center transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105 active:scale-95"
    >
      Comprar Ahora
    </a>
  </div>
</div>

<style>
  .mobile-menu {
    transform: translateX(100%);
  }

  .mobile-menu.menu-open {
    transform: translateX(0) !important;
  }

  .mobile-backdrop.backdrop-open {
    opacity: 1 !important;
    visibility: visible !important;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const mobileMenuButton = document.querySelector(".mobile-menu-button");
    const mobileCloseButton = document.querySelector(".mobile-close-button");
    const mobileMenu = document.querySelector(".mobile-menu");
    const mobileBackdrop = document.querySelector(".mobile-backdrop");

    function openMenu() {
      mobileMenu?.classList.add("menu-open");
      mobileBackdrop?.classList.add("backdrop-open");
      document.body.style.overflow = "hidden";
    }

    function closeMenu() {
      mobileMenu?.classList.remove("menu-open");
      mobileBackdrop?.classList.remove("backdrop-open");
      document.body.style.overflow = "";
    }

    // Open menu
    mobileMenuButton?.addEventListener("click", openMenu);

    // Close menu with close button
    mobileCloseButton?.addEventListener("click", closeMenu);

    // Close menu when clicking backdrop
    mobileBackdrop?.addEventListener("click", closeMenu);

    // Close menu when clicking any link
    const menuLinks = mobileMenu?.querySelectorAll("a");
    menuLinks?.forEach((link) => {
      link.addEventListener("click", closeMenu);
    });

    // Close menu on escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        closeMenu();
      }
    });
  });
</script>
