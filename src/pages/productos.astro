---
import Layout from "../layouts/Layout.astro";
import SectionContainer from "../components/SectionContainer.astro";
import ProductItem from "../components/ProductItem.astro";
import { PRODUCTS } from "../consts/products";
import FeaturesSection from "../components/FeaturesSection.astro";
import { Image } from "astro:assets";
import yellowBgImage from "../assets/images/yellow-bg-image.webp";

const activeProducts = PRODUCTS.filter((product) => product.isActive);
---

<Layout
  title="Productos Premium - HARDY"
  description="Descubrí nuestra colección de pastas de maní ultra premium elaboradas para atletas y fanáticos del fitness."
>
  <main class="pt-16">
    <!-- Hero Section -->
    <SectionContainer
      id="hero"
      class="relative py-16 overflow-hidden"
      noContainer={true}
    >
      <div class="absolute inset-0 bg-cream"></div>
      <div
        class="absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(195,33,54,0.08),transparent_55%)]"
      >
      </div>
      <div
        class="relative max-w-7xl mx-auto px-6 lg:px-8 text-center scrolling-section opacity-0"
      >
        <h1
          class="text-5xl md:text-6xl font-header font-extrabold text-primary uppercase mb-6"
        >
          Nuestros Productos
        </h1>
        <p class="text-xl text-neutral-700 max-w-4xl leading-relaxed mx-auto">
          Energía natural en cada variedad.
        </p>
      </div>
    </SectionContainer>

    <!-- Products Grid -->
    <SectionContainer id="products" class="py-16 bg-white">
      <div class="scrolling-section opacity-0">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {
            activeProducts.map((product) => (
              <ProductItem product={product} variant="detailed" />
            ))
          }
        </div>
      </div>
    </SectionContainer>

    <!-- Features Section -->
    <SectionContainer id="features" class="py-24 relative overflow-hidden">
      <!-- Background image -->
      <div class="absolute inset-0">
        <Image
          src={yellowBgImage}
          alt="Hardy Features background"
          class="w-full h-full object-cover"
          loading="lazy"
          quality={85}
        />
      </div>

      <div class="relative z-10">
        <FeaturesSection
          titleColor="text-primary"
          bgColor="bg-secondary-500/80"
          borderColor="ring-secondary-600 hover:ring-secondary-900"
          iconColor="text-primary"
          cardTitleColor="text-primary"
          cardDescriptionColor="text-black"
        />
      </div>
    </SectionContainer>
  </main>
</Layout>

<script>
  import { animate, stagger, inView } from "motion";

  const isMobile = window.innerWidth < 768;
  const threshold = isMobile ? 0.05 : 0.1;

  inView(
    ".scrolling-section",
    (element) => {
      animate(
        element,
        { opacity: [0, 1], y: [50, 0] },
        { ease: [0.39, 0.24, 0.3, 1], duration: 1 },
      );

      const cards = element.querySelectorAll(".card");
      if (cards.length > 0) {
        animate(
          cards,
          { opacity: [0, 1], y: [25, 0] },
          { type: "spring", delay: stagger(0.15, { startDelay: 0.25 }) },
        );
      }
    },
    { amount: threshold },
  );
</script>
