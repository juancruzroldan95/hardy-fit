---
import Layout from "../layouts/Layout.astro";
import SectionContainer from "../components/SectionContainer.astro";
import { FAQS } from "../consts/faqs";
---

<Layout
  title="Preguntas Frecuentes - HARDY"
  description="Respondemos las dudas más comunes sobre nuestros productos, compras y envíos."
>
  <main class="pt-16">
    <!-- Hero Section -->
    <SectionContainer
      id="hero"
      class="relative py-16 overflow-hidden"
      noContainer={true}
    >
      <div class="absolute inset-0 bg-cream"></div>
      <div
        class="absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(195,33,54,0.08),transparent_55%)]"
      >
      </div>
      <div
        class="relative max-w-4xl mx-auto px-6 lg:px-8 text-center scrolling-section opacity-0"
      >
        <h1
          class="text-3xl md:text-4xl font-header font-extrabold text-primary uppercase mb-4 text-center"
        >
          Preguntas frecuentes
        </h1>
        <p class="text-neutral-700 text-center mb-8">
          Acá vas a encontrar respuestas rápidas sobre productos, compras,
          envíos y más. Si todavía te queda alguna duda, podés escribirnos
          cuando quieras.
        </p>
      </div>
    </SectionContainer>

    <!-- FAQ Section -->
    <SectionContainer id="faq" class="py-16 bg-white">
      <div class="max-w-4xl mx-auto scrolling-section opacity-0 space-y-6">
        <!-- <h2
          class="text-3xl md:text-4xl font-header font-extrabold text-primary uppercase mb-4 text-center"
        >
          Todo lo que necesitás saber
        </h2>
        <p class="text-neutral-700 text-center mb-8">
          Si tu pregunta no está acá, escribinos por WhatsApp o desde la sección
          de contacto y te ayudamos.
        </p> -->

        <div class="space-y-4">
          {
            FAQS.map((section) => (
              <div class="bg-neutral-50 rounded-2xl p-6">
                <h3 class="text-xl font-header font-bold text-primary mb-4">
                  {section.title}
                </h3>
                <div class="space-y-2">
                  {section.items.map((item) => (
                    <>
                      <button
                        class="faq-item w-full text-left py-3 flex items-center justify-between gap-4 border-b border-neutral-200 last:border-b-0"
                        data-faq-id={item.id}
                      >
                        <span class="font-semibold text-neutral-900">
                          {item.question}
                        </span>
                        <span class="faq-icon text-primary text-2xl leading-none select-none">
                          +
                        </span>
                      </button>
                      <div
                        class="faq-panel max-h-0 overflow-hidden transition-all duration-300 ease-[cubic-bezier(0.25,0.8,0.25,1)]"
                        data-faq-panel={item.id}
                      >
                        <p class="pt-2 text-neutral-700">{item.answer}</p>
                      </div>
                    </>
                  ))}
                </div>
              </div>
            ))
          }
        </div>

        <div class="mt-10 text-center">
          <p class="text-neutral-700 mb-4">¿No encontraste lo que buscabas?</p>
          <a
            href="/contactanos"
            class="inline-block bg-primary text-white px-8 py-3 rounded-full font-bold uppercase text-sm md:text-base transition-all duration-300 hover:scale-105 hover:shadow-lg"
          >
            Ir a Contacto
          </a>
        </div>
      </div>
    </SectionContainer>
  </main>
</Layout>

<script>
  import { animate, stagger, inView } from "motion";

  const isMobile = window.innerWidth < 768;
  const threshold = isMobile ? 0.1 : 0.2;

  inView(
    ".scrolling-section",
    (element) => {
      animate(
        element,
        { opacity: [0, 1], y: [50, 0] },
        { ease: [0.39, 0.24, 0.3, 1], duration: 1 },
      );
    },
    { amount: threshold },
  );

  // Simple accordion with smooth height transition
  document.addEventListener("DOMContentLoaded", () => {
    const items = document.querySelectorAll<HTMLButtonElement>(".faq-item");

    items.forEach((item) => {
      item.addEventListener("click", () => {
        const id = item.getAttribute("data-faq-id");
        if (!id) return;

        const panel = document.querySelector<HTMLDivElement>(
          `[data-faq-panel="${id}"]`,
        );
        const icon = item.querySelector<HTMLElement>(".faq-icon");

        if (!panel) return;

        const isOpen = panel.classList.contains("open");

        // Close all panels
        document
          .querySelectorAll<HTMLDivElement>(".faq-panel.open")
          .forEach((openPanel) => {
            openPanel.style.maxHeight = "0px";
            openPanel.classList.remove("open");
          });
        document
          .querySelectorAll<HTMLElement>(".faq-icon")
          .forEach((iconEl) => {
            iconEl.textContent = "+";
          });

        // Toggle current
        if (!isOpen) {
          panel.classList.add("open");
          panel.style.maxHeight = panel.scrollHeight + "px";
          if (icon) icon.textContent = "−";
        }
      });
    });
  });
</script>
