---
import Layout from "../layouts/Layout.astro";
import SectionContainer from "../components/SectionContainer.astro";
import { Image } from "astro:assets";

import HeroSection from "../components/HeroSection.astro";
import ProductsSection from "../components/ProductsSection.astro";
import ValuesHeroSection from "../components/ValuesHeroSection.astro";
import ValuesSection from "../components/ValuesSection.astro";
import CTASection from "../components/CTASection.astro";
import ctaBgImage from "../assets/images/skyblue-bg-image.webp";
import yellowBgImage from "../assets/images/yellow-bg-image.webp";
---

<Layout title="HARDY - AlimentÃ¡ tu instinto">
  <main>
    <SectionContainer
      id="hero"
      class="relative min-h-screen flex items-center justify-center overflow-hidden"
      noContainer={true}
    >
      <HeroSection />
    </SectionContainer>

    <SectionContainer id="products" class="py-24 bg-neutral-50">
      <ProductsSection />
    </SectionContainer>

    <SectionContainer id="why-choose-us" class="py-24 relative overflow-hidden">
      <div class="absolute inset-0">
        <Image
          src={yellowBgImage}
          alt="Hardy Values background"
          class="w-full h-full object-cover"
          loading="lazy"
          quality={85}
        />
      </div>

      <div class="relative z-10">
        <ValuesHeroSection
          titleColor="text-primary"
          titleSize="text-4xl md:text-5xl"
          descriptionColor="text-black"
        />
        <ValuesSection
          titleColor="text-primary"
          bgColor="bg-secondary-500/80"
          borderColor="ring-secondary-600 hover:ring-secondary-900"
          iconColor="text-primary"
          cardTitleColor="text-primary"
          cardDescriptionColor="text-black"
        />
      </div>
    </SectionContainer>

    <SectionContainer id="cta" class="py-24 relative overflow-hidden">
      <!-- Background image -->
      <div class="absolute inset-0">
        <Image
          src={ctaBgImage}
          alt="Hardy CTA background"
          class="w-full h-full object-cover"
          loading="lazy"
          quality={85}
        />
      </div>

      <div class="relative z-10">
        <CTASection
          titleColor="text-primary"
          buttonBgColor="bg-primary"
          buttonTextColor="text-white"
        />
      </div>
    </SectionContainer>
  </main>
</Layout>

<script>
  import { animate, stagger, inView } from "motion";

  // Detect mobile and use different thresholds
  const isMobile = window.innerWidth < 768;
  const threshold = isMobile ? 0.1 : 0.2;

  inView(
    ".scrolling-section",
    (element) => {
      animate(
        element,
        { opacity: [0, 1], y: [50, 0] },
        { ease: [0.39, 0.24, 0.3, 1], duration: 1 },
      );

      const cards = element.querySelectorAll(".card");
      if (cards.length > 0) {
        animate(
          cards,
          { opacity: [0, 1], y: [25, 0] },
          { type: "spring", delay: stagger(0.25, { startDelay: 0 }) },
        );
      }

      // Staggered animation for hero text elements
      const heroTexts = element.querySelectorAll(".hero-text");
      if (heroTexts.length > 0) {
        animate(
          heroTexts,
          { opacity: [0, 1], y: [30, 0] },
          {
            ease: [0.39, 0.24, 0.3, 1],
            duration: 0.8,
            delay: stagger(0.2, { startDelay: 0.3 }),
          },
        );
      }

      // Animate hero buttons after text
      const heroButtons = element.querySelector(".hero-buttons");
      if (heroButtons) {
        animate(
          heroButtons,
          { opacity: [0, 1], y: [20, 0] },
          { ease: [0.39, 0.24, 0.3, 1], duration: 0.8, delay: 1.4 },
        );
      }
    },
    { amount: threshold },
  );
</script>
